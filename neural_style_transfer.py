<PASTE THE FULL CODE I SHARED EARLIER HERE>